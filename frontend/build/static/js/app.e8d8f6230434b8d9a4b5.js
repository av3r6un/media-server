webpackJsonp([1],{"0euI":function(e,t){},"9Ykw":function(e,t){},"9jDJ":function(e,t){},Bmq5:function(e,t){},Ekv9:function(e,t){},MPUf:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("7+uW"),i=s("sUu7"),n=s("fZjL"),o=s.n(n),r=s("Dd8w"),l=s.n(r),c=s("mvHQ"),u=s.n(c),d=s("Xxa5"),v=s.n(d),p=s("exGp"),m=s.n(p),h=s("Zrlr"),f=s.n(h),_=s("wxAW"),g=s.n(_),w=s("mtWM");function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main",t=JSON.parse(localStorage.getItem("user")),s=null;return t&&(s={Authorization:"Bearer "+t[{main:"accs_token",refresh:"rfsh_token"}[e]]}),s}var C,y=(C=document.cookie.split("; ").find(function(e){return e.startsWith("csrftoken=")}))?C.split("=")[1]:null;w.a.defaults.headers.common.HTTP_X_CSRFTOKEN=y;var k=function(){function e(){f()(this,e)}return g()(e,[{key:"get",value:function(){var e=m()(v.a.mark(function e(t){var s=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.msg=null,e.abrupt("return",w.a.get(t,{headers:b(),params:a}).then(function(e){return"success"===e.data.status?e.data:(s.msg=e.data.message,null)}).catch(function(e){return console.error(e)}));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getResp",value:function(){var e=m()(v.a.mark(function e(t){var s=this;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return delete w.a.defaults.headers.common.HTTP_X_CSRFTOKEN,this.msg=null,e.abrupt("return",w.a.get(t).then(function(e){return e.data?e.data:(s.msg="Error while requesting "+t,null)}).catch(function(e){return console.log(e)}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getFiles",value:function(){var e=m()(v.a.mark(function e(t){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.msg=null,e.abrupt("return",w.a.get(t,{headers:b()}).then(function(e){return e.data}).catch(function(e){return console.error(e)}));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=m()(v.a.mark(function e(t,s){var a=this;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.msg=null,this.headers=b(),this.headers["Content-Type"]=s instanceof FormData?"multipart/form-data":"application/json",e.abrupt("return",w.a.post(t,s,{headers:this.headers}).then(function(e){return"success"===e.data.status?(e.data.message&&(a.msg=e.data.message),e.data):(a.msg=e.data.message,null)}).catch(function(e){return console.error(e)}));case 4:case"end":return e.stop()}},e,this)}));return function(t,s){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=m()(v.a.mark(function e(t){var s=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.msg=null,this.headers=b(),this.headers["Content-Type"]="application/json",e.abrupt("return",w.a.delete(t,{data:a,headers:this.headers}).then(function(e){return"success"===e.data.status?e.data:(s.msg=e.data.message,null)}).catch(function(e){return console.error(e)}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"beacon",value:function(){var e=m()(v.a.mark(function e(t){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.msg=null,this.data=t,this.data.headers=b(),e.abrupt("return",navigator.sendBeacon("/api/watch/beacon",u()(this.data)));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}(),x={name:"Header",data:function(){return{backend:new k,showSearchResult:!1,searchResultLoading:!1,keyword:null,results:[],staticUrl:"",showQueue:null,queueLength:null}},methods:{keywordChange:function(){""!==event.target.value?this.showSearchResult=!0:this.showSearchResult=!1},retrieveResults:function(){var e=this;this.results.length<=0&&this.backend.get("/api/all/").then(function(t){t?e.results=t.body:console.log(e.backend.message)}).catch(function(e){return console.error(e)})},redirect:function(e){location.href=e},updateQueue:function(e){if(e){if("queueUpdate"===e.type){var t=JSON.parse(e.detail.storage);this.queueLength=t?t.length:null,this.queueLength?this.showQueue=!0:this.showQueue=!1}}else{var s=JSON.parse(localStorage.getItem("queue"));s&&s.length&&(this.showQueue=!0,this.queueLength=s.length)}},logout:function(){this.$store.dispatch("logout")}},mounted:function(){this.updateQueue(),window.addEventListener("queueUpdate",this.updateQueue)},computed:{filteredList:function(){var e=this;return this.results.filter(function(t){var s=l()({},t);return e.keyword?o()(s).some(function(t){return(""+s[t]).toLowerCase().includes(e.keyword.toLowerCase())}):null})},filteredListStyle:function(){return"height: "+(this.filteredList.length>1&&this.filteredList.length<5?120*this.filteredList.length:this.filteredList.length>=5?480:120)+"px"},lazyLoad:function(){return!(this.filteredList.length>1)},emptyResult:function(){return this.filteredList.length<1}},beforeDestroy:function(){window.removeEventListener("queueUpdate",this.updateQueue)}},I={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("header",{staticClass:"header"},[s("div",{staticClass:"header_navbar"},[e._m(0),e._v(" "),e._m(1),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),s("div",{staticClass:"header_navbar-item last"},[s("div",{staticClass:"search_wrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.keyword,expression:"keyword"}],staticClass:"input_wide solo_input",attrs:{type:"text",placeholder:"Поиск"},domProps:{value:e.keyword},on:{input:[function(t){t.target.composing||(e.keyword=t.target.value)},e.keywordChange],focus:e.retrieveResults}}),e._v(" "),s("transition",{attrs:{name:"toggle"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.showSearchResult,expression:"showSearchResult"}],staticClass:"search_result",style:e.filteredListStyle},[e._l(e.filteredList,function(t){return s("div",{key:t.uid,staticClass:"search_result_item",on:{click:function(s){return e.redirect(t.uid)}}},[s("div",{staticClass:"item_wrapper"},[s("div",{staticClass:"item_poster"},[s("img",{staticClass:"small_poster",attrs:{src:"/i/"+t.poster}})]),e._v(" "),s("div",{staticClass:"item_info"},[s("div",{staticClass:"info_name"},[e._v(e._s(t.name)+" ("+e._s(t.year)+")")]),e._v(" "),s("div",{staticClass:"info_or_name"},[s("i",{staticClass:"ms-icon wh-20",class:t.media_type}),e._v("\n                  "+e._s(t.original_name)+"\n                ")]),e._v(" "),s("div",{staticClass:"info_rate"},[s("div",{staticClass:"rate_name"},[e._v("iMDB")]),e._v("\n                  "+e._s(t.imdb_rate)+"\n                ")])])])])}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.lazyLoad,expression:"lazyLoad"}],staticClass:"empty_result",style:e.emptyResult?"":"margin: 10px 0 !important;"},[e.emptyResult?s("div",{staticClass:"empty_text"},[e._v("Ничего не найдено")]):e._e(),e._v(" "),s("a",{staticClass:"base_link hidden_link",attrs:{href:e.keyword?"/search?k="+e.keyword:"/search"}},[e._v("Глобальный поиск")])])],2)])],1),e._v(" "),s("div",{staticClass:"user_item"},[e._m(4),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showQueue,expression:"showQueue"}],staticClass:"queue_counter"},[e._v(e._s(e.queueLength))])])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header_navbar-item"},[t("div",{staticClass:"logo_wrapper"},[t("a",{staticClass:"base_link",attrs:{href:"/"}},[t("img",{attrs:{src:"/static/logo.png",alt:"logo"}})])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header_navbar-item"},[t("a",{staticClass:"base_link",attrs:{href:"/tv"}},[this._v("Сериалы")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header_navbar-item"},[t("a",{staticClass:"base_link",attrs:{href:"/movie"}},[this._v("Фильмы")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header_navbar-item"},[t("a",{staticClass:"base_link",attrs:{href:"/video"}},[this._v("Видео")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("a",{staticClass:"base_link",attrs:{href:"/user"}},[t("i",{staticClass:"ms-icon user-circle wh-30"})])}]};var S=s("VU/8")(x,I,!1,function(e){s("pdYJ")},"data-v-087c9ae0",null).exports,L=new(function(){function e(){f()(this,e)}return g()(e,[{key:"getMe",value:function(){var e=m()(v.a.mark(function e(){var t=this;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.msg="auth",!localStorage.getItem("user")){e.next=3;break}return e.abrupt("return",w.a.get("/auth/get-me/",{headers:b("main")}).then(function(e){return"success"===e.data.status&&e.data.granted?t.msg="granted":(localStorage.removeItem("user"),t.msg="auth"),t.msg}).catch(function(e){401===e.response.status&&("TNF"===e.response.data.msg?t.msg="auth":"THE"===e.response.data.msg&&(t.refresh(),t.msg="refresh"))}));case 3:return e.abrupt("return",this.msg);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=m()(v.a.mark(function e(){var t=this;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.user=JSON.parse(localStorage.getItem("user")),e.abrupt("return",w.a.post("/auth/refresh/",{},{headers:b("refresh")}).then(function(e){"success"===e.data.status&&(t.user.accs_token=e.data.token),localStorage.setItem("user",u()(t.user)),location.reload()}).catch(function(e){console.log(e),"THE"===e.response.data.msg&&(t.msg="auth",localStorage.removeItem("user"),location.href="/sign-in")}).finally(function(){return t.msg}));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}()),$={name:"App",data:function(){return{}},components:{vueHeader:S},methods:{manageTitle:function(){document.title=this.$route.name+" » MediaServer"}},mounted:function(){L.getMe().then(function(e){"auth"===e||"refresh"===e?"/sign-in"!==location.pathname&&(location.href="/sign-in"):"granted"!==e&&console.log(e)}),this.manageTitle()},computed:{notFound:function(){return"undefined"===this.$route.meta.type}}},M={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[this.$store.getters.isAuthenticated&&!this.notFound?t("vueHeader",{ref:"header"}):this._e(),this._v(" "),t("router-view")],1)},staticRenderFns:[]};var P=s("VU/8")($,M,!1,function(e){s("lfw6")},null,null).exports,q=s("/ocq"),E=s("//Fk"),U=s.n(E),N=s("NYxO");var D=function(){var e=document.cookie.split("; ").find(function(e){return e.startsWith("csrftoken=")});return e?e.split("=")[1]:null}();w.a.defaults.headers.common.HTTP_X_CSRFTOKEN=D;var B=new(function(){function e(){f()(this,e)}return g()(e,[{key:"login",value:function(){var e=m()(v.a.mark(function e(t){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.smth=null,e.abrupt("return",w.a.post("/auth/",t).then(function(e){return"success"===e.data.status&&(localStorage.setItem("user",u()(e.data.body)),console.log(e)),e.data.body}).catch(function(e){return console.log(e)}));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=m()(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.smth=null,e.abrupt("return",w.a.get("/auth/logout/",{headers:b("main")}).then(function(e){return e.data.message}).catch(function(e){return console.error(e)}).finally(function(){localStorage.removeItem("user"),localStorage.removeItem("queue"),localStorage.removeItem("aDownloads"),location.href="/"}));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=m()(v.a.mark(function e(t){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.smth=null,e.abrupt("return",w.a.post("/auth/register/",t).then(function(e){return e.data.message}).catch(function(e){return console.error(e)}));case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}());a.a.use(N.a);var F=JSON.parse(localStorage.getItem("user")),T=F?{isAuthenticated:!0,uuid:F.uid}:{isAuthenticated:!1,uuid:null},R=new N.a.Store({state:T,mutations:{login:function(e,t){e.uuid=t.uid,e.isAuthenticated=!0},logout:function(e){e.isAuthenticated=!1},register:function(e,t){e.uuid=t.uid,e.isAuthenticated=!1},refresh:function(e){e.isAuthenticated=!0}},actions:{login:function(e,t){var s=this,a=e.commit;return m()(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B.login(t).then(function(e){return a("login",e),U.a.resolve(e)}));case 1:case"end":return e.stop()}},e,s)}))()},logout:function(e){var t=this,s=e.commit;return m()(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:B.logout(),s("logout");case 2:case"end":return e.stop()}},e,t)}))()},refresh:function(e,t){var s=this,a=e.commit;return m()(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B.refresh(t).then(function(){return a("refresh")}));case 1:case"end":return e.stop()}},e,s)}))()},register:function(e,t){var s=this,a=e.commit;return m()(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B.register(t).then(function(e){return a("register",e),U.a.resolve(e)}));case 1:case"end":return e.stop()}},e,s)}))()}},getters:{isAuthenticated:function(e){return e.isAuthenticated},uuid:function(e){return e.uuid}}}),A={name:"Index",data:function(){return{backend:new k,advice:{continue:null,new:null},unwatched:{movies:null,tvs:null},loading:!1,movies:null,tvs:null}},methods:{retrieveAdvice:function(){var e=this;this.loading=!0,this.backend.get("/api/user/advice").then(function(t){t&&(e.advice.continue=t.body.unwatched,e.advice.new=t.body.new,e.unwatched.movies=t.body.movies,e.unwatched.tvs=t.body.tvs)}).catch(function(e){return console.error(e)}).finally(function(){e.loading=!1})},hideFromAdvice:function(){}},created:function(){this.retrieveAdvice()}},O={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("article",{staticClass:"index page_wrapper"},[e.loading?s("div",{staticClass:"loading"},[s("svg",{attrs:{width:"32px",height:"24px"}},[s("polyline",{attrs:{id:"back",points:"1 6 4 6 6 11 10 1 12 6 15 6"}}),e._v(" "),s("polyline",{attrs:{id:"front",points:"1 6 4 6 6 11 10 1 12 6 15 6"}})])]):s("div",{staticClass:"page_content"},[s("div",{staticClass:"advice"},[s("div",{staticClass:"block_title"},[e._v("Продолжить просмотр")]),e._v(" "),s("div",{ref:"aWrapper",staticClass:"advice_wrapper"},[e._l(e.advice.continue,function(t){return s("div",{key:t.uid,staticClass:"advice_continue"},[s("div",{staticClass:"continue_card"},[s("img",{staticClass:"base_image preview_image",attrs:{src:"/i/"+t.picture,alt:""}}),e._v(" "),s("div",{staticClass:"continue_actions"},[s("div",{staticClass:"continue_action play_button"},[s("a",{staticClass:"base_link",attrs:{href:"episode"===t.type?"/watch/"+t.uid+"?c="+t.continue:"/"+t.uid+"?c="+t.continue}},[s("i",{staticClass:"ms-icon play wh-20"})])]),e._v(" "),s("div",{staticClass:"continue_action hide_button"},[s("a",{staticClass:"base_link",on:{click:function(s){return e.hideFromAdvice(t.w_uid)}}},[s("i",{staticClass:"ms-icon xmark wh-20"})])]),e._v(" "),s("div",{staticClass:"continue_runtime"},[s("div",{staticClass:"runtime_wrapper"},[e._v("\n                  ~\n                   "+e._s(parseInt(parseInt(t.runtime,10)-parseInt(t.continue,10)/60,10))+" мин\n                ")])])])]),e._v(" "),s("div",{staticClass:"continue_name"},[e._v(e._s(t.name))]),e._v(" "),s("div",{staticClass:"continue_info"},[e._v(e._s(t.additional))])])}),e._v(" "),e._l(e.advice.new,function(t){return s("div",{key:t.uid,staticClass:"advice_new"},[s("div",{staticClass:"new_card"},[s("img",{staticClass:"base_image preview_image",attrs:{src:"/i/"+t.picture,alt:""}}),e._v(" "),s("div",{staticClass:"new_actions"},[s("div",{staticClass:"new_action play_button"},[s("a",{staticClass:"base_link",attrs:{href:"movie"===t.type?"/"+t.uid:"/watch/"+t.uid}},[s("i",{staticClass:"ms-icon play wh-20"})])])])]),e._v(" "),s("div",{staticClass:"new_name",attrs:{title:t.name}},[e._v(e._s(t.name))]),e._v(" "),s("div",{staticClass:"new_info",attrs:{title:t.additional}},[e._v(e._s(t.additional))])])})],2)]),e._v(" "),s("div",{staticClass:"tvs"},[s("div",{staticClass:"block_title"},[e._v("Сериалы")]),e._v(" "),s("div",{staticClass:"tvs_wrapper"},e._l(e.unwatched.tvs,function(t){return s("div",{key:t.uid,staticClass:"tv_item"},[s("a",{staticClass:"base_link",attrs:{href:"/"+t.uid}},[s("div",{staticClass:"tv_image"},[t.poster?s("img",{staticClass:"base_image",attrs:{src:"/i/"+t.poster,alt:""}}):e._e()]),e._v(" "),s("div",{staticClass:"tv_name"},[e._v(e._s(t.name)+" ("+e._s(t.original_name)+")")])])])}),0)]),e._v(" "),s("div",{staticClass:"movies"},[s("div",{staticClass:"block_title"},[e._v("Фильмы")]),e._v(" "),s("div",{staticClass:"movies_wrapper"},e._l(e.unwatched.movies,function(t){return s("div",{key:t.uid,staticClass:"movie_item"},[s("a",{staticClass:"base_link",attrs:{href:"/"+t.uid+(!t.seen&&t.continue>0?"?c="+t.continue:"")}},[s("div",{staticClass:"movie_image"},[t.poster?s("img",{staticClass:"base_image",attrs:{src:"/i/"+t.poster,alt:""}}):e._e()]),e._v(" "),s("div",{staticClass:"movie_name"},[e._v(e._s(t.name)+" ("+e._s(t.original_name)+")")])])])}),0)])])])},staticRenderFns:[]};var V=s("VU/8")(A,O,!1,function(e){s("hpD4")},"data-v-7fccf51a",null).exports,H={name:"Auth",data:function(){return{user:{username:null,password:null},lostPassword:{email:null},showLogin:!0,showLost:!1}},methods:{handleLogin:function(){this.$store.dispatch("login",this.user).then(function(e){console.log(e),location.href="/"})},handleLost:function(){},showLostForm:function(){}},mounted:function(){this.$store.state.isAuthenticated&&(location.href="/")},created:function(){}},Q={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("article",{staticClass:"auth page_wrapper"},[s("div",{staticClass:"auth_header"}),e._v(" "),s("div",{staticClass:"page_content"},[e._v("Добро пожаловать в медиацентр!")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showLogin,expression:"showLogin"}],staticClass:"auth_wrapper"},[s("div",{staticClass:"container_title"},[e._v("Авторизация")]),e._v(" "),s("form",{staticClass:"auth_form",on:{submit:function(t){return t.preventDefault(),e.handleLogin.apply(null,arguments)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.username,expression:"user.username"}],staticClass:"input_wide",attrs:{type:"text",required:"",autocomplete:"off",placeholder:"Логин",autofocus:""},domProps:{value:e.user.username},on:{input:function(t){t.target.composing||e.$set(e.user,"username",t.target.value)}}}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],staticClass:"input_wide",attrs:{type:"password",required:"",autocomplete:"off",placeholder:"Пароль"},domProps:{value:e.user.password},on:{input:function(t){t.target.composing||e.$set(e.user,"password",t.target.value)}}}),e._v(" "),s("div",{staticClass:"form_row"},[s("a",{staticClass:"base_link",on:{click:e.showLostForm}},[e._v("Забыли пароль?")])]),e._v(" "),s("button",{ref:"loginButton",staticClass:"btn btn_submit",attrs:{type:"submit"}},[e._v("Войти")])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showLost,expression:"showLost"}],staticClass:"lostpassword_wrapper"},[s("div",{staticClass:"container_title"},[e._v("Восттановить пароль")]),e._v(" "),s("form",{staticClass:"lost_form",on:{submit:function(t){return t.preventDefault(),e.handleLost.apply(null,arguments)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.lostPassword.email,expression:"lostPassword.email"}],staticClass:"input_wide",attrs:{type:"text",required:"",autocomplete:"off",placeholder:"Е-mail"},domProps:{value:e.lostPassword.email},on:{input:function(t){t.target.composing||e.$set(e.lostPassword,"email",t.target.value)}}}),e._v(" "),s("button",{staticClass:"btn btn_submit",attrs:{type:"submit"}},[e._v("Восстановить")])])])])},staticRenderFns:[]};var j=s("VU/8")(H,Q,!1,function(e){s("py20")},"data-v-2cf2ffe6",null).exports,J={name:"Search",data:function(){return{backend:new k,params:{keyword:null},results:null,extra:{imageStorage:null,duplicates:null},currentItem:{},loading:!1}},methods:{retrieveResults:function(){var e=this;this.params.keyword&&(this.results=null,this.loading=!0,this.backend.get("/api/search/",this.params).then(function(t){t?(e.extra=t.extra,e.results=t.body):console.log(e.backend.msg)}).catch(function(e){return console.error(e)}).finally(function(){e.loading=!1}))},addNewItem:function(e){var t=this,s=this.$refs.buttonAdd[e].textContent,a=this.results[e].media_type;this.$refs.buttonAdd[e].textContent="",this.currentItem=this.results[e];var i="";this.backend.post("/api/"+a+"/",this.currentItem).then(function(a){a?(i=a.body,t.$refs.buttonAdd[e].textContent=s,t.results.splice(e,1)):console.log(t.backend.msg)}).catch(function(e){return console.error(e)}).finally(function(){0===t.results.length&&(location.href=i.uid)})},paintRate:function(e){var t="background: #777777;";if(e&&"-"!==e){var s=parseInt(10*e,10);s<49?t="background: #ff0000":s>70&&(t="background: #3bb33b")}return t},checkDuplicate:function(e){return!!this.extra.duplicates&&this.extra.duplicates.includes(e)}},created:function(){this.params.keyword=this.$route.query.k,this.retrieveResults()}},W={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("article",{staticClass:"search page_wrapper"},[s("div",{staticClass:"search_wrapper"},[s("form",{staticClass:"global_search",on:{submit:function(t){return t.preventDefault(),e.retrieveResults.apply(null,arguments)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.params.keyword,expression:"params.keyword"}],staticClass:"input_wide",attrs:{type:"text",placeholder:"Найдётся всё",required:""},domProps:{value:e.params.keyword},on:{input:function(t){t.target.composing||e.$set(e.params,"keyword",t.target.value)}}}),e._v(" "),s("button",{staticClass:"btn btn_submit",attrs:{type:"submit"}},[e._v("Поиск")])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.results,expression:"results"}],staticClass:"search_results"},e._l(e.results,function(t,a){return s("div",{key:t.tmdb_id,staticClass:"search_results-card"},[s("div",{staticClass:"card_poster"},[s("img",{staticClass:"bg_image",attrs:{src:""+e.extra.imageStorage+t.poster,alt:t.original_name+" poster"}})]),e._v(" "),s("div",{staticClass:"card_info"},[s("div",{staticClass:"card_bg"},[s("img",{staticClass:"bg_image",attrs:{src:""+e.extra.imageStorage+t.backdrop,alt:t.original_name+" background"}})]),e._v(" "),s("div",{staticClass:"card_name no_select"},[s("i",{staticClass:"ms-icon wh-30",class:t.media_type}),e._v("\n          "+e._s(t.name)+" ("+e._s(t.year)+")\n        ")]),e._v(" "),s("div",{staticClass:"card_rating no_select"},[s("div",{staticClass:"rater_object",style:e.paintRate(t.tmdb_rate)},[s("div",{staticClass:"rate_name tmdb"},[e._v("TMDb")]),e._v(" "),s("div",{staticClass:"rate_value"},[e._v(e._s(t.tmdb_rate))])]),e._v(" "),s("div",{staticClass:"rater_object",style:e.paintRate(t.kp_rate)},[s("div",{staticClass:"rate_name kp"},[e._v("КП")]),e._v(" "),s("div",{staticClass:"rate_value"},[e._v(e._s(t.kp_rate))])])]),e._v(" "),s("div",{staticClass:"card_overview no_select",attrs:{title:t.overview}},[e._v("\n          "+e._s(t.overview)+"\n        ")]),e._v(" "),e.checkDuplicate(t.tmdb_id)?e._e():s("div",{staticClass:"card_action"},[s("button",{ref:"buttonAdd",refInFor:!0,staticClass:"btn btn_submit btn_add",attrs:{type:"button"},on:{click:function(t){return e.addNewItem(a)}}},[e._v("Добавить")])])])])}),0),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"search_results-loading"},[s("div",{staticClass:"loading"},[s("svg",{attrs:{width:"32px",height:"24px"}},[s("polyline",{attrs:{id:"back",points:"1 6 4 6 6 11 10 1 12 6 15 6"}}),e._v(" "),s("polyline",{attrs:{id:"front",points:"1 6 4 6 6 11 10 1 12 6 15 6"}})])])])])},staticRenderFns:[]};var Y=s("VU/8")(J,W,!1,function(e){s("9Ykw")},"data-v-5dd7a156",null).exports,X={name:"MediaElements",data:function(){return{backend:new k,mediaType:null,media:null,loading:!0}},methods:{retrieveMedia:function(){var e=this;this.backend.get("/api/"+this.mediaType+"/").then(function(t){e.media=t.body}).catch(function(e){return console.error(e)}).finally(function(){e.loading=!1,console.log(e.media)})}},created:function(){this.mediaType=this.$route.meta.mediaType,this.retrieveMedia()}},z={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("article",{staticClass:"main_content page_wrapper"},[e.loading?s("div",{staticClass:"loading"},[s("svg",{attrs:{width:"32px",height:"24px"}},[s("polyline",{attrs:{id:"back",points:"1 6 4 6 6 11 10 1 12 6 15 6"}}),e._v(" "),s("polyline",{attrs:{id:"front",points:"1 6 4 6 6 11 10 1 12 6 15 6"}})])]):s("div",{staticClass:"page_content"},[s("div",{staticClass:"elements_wrapper"},e._l(e.media,function(t){return s("div",{key:t.uid,staticClass:"media"},[s("a",{staticClass:"base_link",attrs:{href:"/"+t.uid+(!t.seen&&t.continue>0?"?c="+t.continue:"")}},[s("div",{staticClass:"media_image"},[t.poster?s("img",{attrs:{src:"/i/"+t.poster}}):e._e()]),e._v(" "),s("div",{staticClass:"media_name"},[e._v(e._s(t.name)+" ("+e._s(t.original_name)+")")])])])}),0)])])},staticRenderFns:[]};var K=s("VU/8")(X,z,!1,function(e){s("Vrte")},"data-v-4a93836e",null).exports,G=s("lHA8"),Z=s.n(G),ee=s("Gu7T"),te=s.n(ee),se={name:"selecter",props:{options:{},multiple:{type:Boolean,default:!1},placeholder:{type:String,default:"Выберите опцию"},updatable:{type:Boolean,default:!1},defaultValue:{type:String,default:null}},data:function(){return{selectionsOpened:!1,selected:null}},methods:{selectThis:function(e){this.selected=e,this.selectionsOpened=!1,this.$emit("input",e)},selectOption:function(e,t){this.selected=e,this.selectionsOpened=!1,this.$emit("input",t)},autoSelect:function(e){this.options[e]&&(this.selected=this.options[e],this.$emit("input",e))},toggleSelections:function(){this.selectionOpened?this.$refs.defaultSelection.classList.remove("opened"):this.$refs.defaultSelection.classList.add("opened"),this.selectionsOpened=!this.selectionOpened},clearSelection:function(){this.selected=null,this.$emit("input",null)},keyboardHandler:function(){this.selectionsOpened&&27===event.which&&(this.selectionsOpened=!1,this.$refs.defaultSelection.classList.remove("opened"))}},mounted:function(){window.addEventListener("keyup",this.keyboardHandler),this.options&&this.$attrs.value&&(this.selected=this.options[this.$attrs.value])},beforeDestroy:function(){window.removeEventListener("keyup",this.keyboardHandler)},updated:function(){var e=this;this.$nextTick(function(){e.updatable&&!e.selected&&e.options&&(e.selected=e.options[e.$attrs.value])})}},ae={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"selection"},[e.multiple?s("div",{directives:[{name:"show",rawName:"v-show",value:e.selectionsOpened,expression:"selectionsOpened"}],staticClass:"selection_options"},e._l(e.options,function(t,a,i){return s("div",{key:i,staticClass:"selection_options-option",on:{click:function(s){return e.selectOption(t,a)}}},[e._v("\n      "+e._s(t)+"\n    ")])}),0):s("div",{directives:[{name:"show",rawName:"v-show",value:e.selectionsOpened,expression:"selectionsOpened"}],staticClass:"selection_options"},e._l(e.options,function(t){return s("div",{key:t,staticClass:"selection_options-option",on:{click:function(s){return e.selectThis(t)}}},[e._v("\n      "+e._s(t)+"\n    ")])}),0),e._v(" "),e.selected?s("div",{staticClass:"selection_selected option_selected",on:{click:e.clearSelection}},[e._v("\n    "+e._s(e.selected)+"\n  ")]):s("div",{ref:"defaultSelection",staticClass:"selection_selected",on:{click:e.toggleSelections}},[s("div",{staticClass:"selection_selected-default"},[e._v(e._s(e.placeholder))])])])},staticRenderFns:[]};var ie=s("VU/8")(se,ae,!1,function(e){s("crH4")},"data-v-3d50b7de",null).exports,ne={name:"msplayer",props:{videoSource:{type:String,default:""},title:{type:String,default:""},preview:{type:String,default:""},subtitle:{type:String,default:""},subLang:{type:String,default:""},continue:{type:Number,default:0},local:{type:Boolean,default:!1},filename:{type:String}},data:function(){return{backend:new k,playerLangs:{eng:"Английский",rus:"Русский"},playerInfo:{duration:null,time:null},player:this.$refs.mainPlayer,showPlayer:!1,Player:null,video:null}},methods:{applyListeners:function(){this.$refs.mainPlayer.addEventListener("start",this.playerStarted),(this.subtitle&&this.subLang||this.local)&&(this.$refs.mainPlayer.addEventListener("fullscreen",this.manageScreen),this.$refs.mainPlayer.addEventListener("exitfullscreen",this.manageScreen)),this.$refs.mainPlayer.addEventListener("buffered",this.playerBuffered),this.$refs.mainPlayer.addEventListener("userpause",this.playerPaused),window.addEventListener("beforeunload",this.beforeWindowUnload),navigator.userAgent.match(/iPhone/i)&&window.addEventListener("pagehide",this.beforeWindowUnload)},deactivateListeners:function(){this.$refs.mainPlayer.removeEventListener("start",this.playerStarted),(this.subtitle&&this.subLang||this.local)&&(this.$refs.mainPlayer.removeEventListener("fullscreen",this.manageScreen),this.$refs.mainPlayer.removeEventListener("exitfullscreen",this.manageScreen)),this.$refs.mainPlayer.removeEventListener("buffered",this.playerBuffered),this.$refs.mainPlayer.removeEventListener("userpause",this.playerPaused),window.removeEventListener("beforeunload",this.beforeWindowUnload),navigator.userAgent.match(/iPhone/i)&&window.removeEventListener("pagehide",this.beforeWindowUnload)},encodeUrl:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"stream",s=new Date;s.setHours(s.getHours()+3);var a=s.getFullYear()+"-"+(s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1)+"-"+(s.getDate()<10?"0"+s.getDate():s.getDate())+" "+(s.getHours()<10?"0"+s.getHours():s.getHours());return"subs"===t?btoa(e+"&"+JSON.parse(localStorage.getItem("user")).uid+"&"+a)+"/"+e+".vtt":btoa(e+"&"+JSON.parse(localStorage.getItem("user")).uid+"&"+a)},playerStarted:function(){this.video=document.querySelector("video"),this.downloadSubtitles(),this.Player.api("subtitles",-1),this.continue&&this.continue>0&&this.Player.api("seek",this.continue)},downloadSubtitles:function(){var e=this,t="";if(this.local){var s=null;this.backend.getFiles("/s/"+this.encodeUrl(this.filename,"subs")).then(function(a){a&&(s=new Blob([a],{type:"text/vtt"}),t='<track default label="'+e.playerLangs[e.subLang]+'" src="'+URL.createObjectURL(s)+'" kind="subtitles" srclang="'+e.subLang+'" mode="hidden" />')}).catch(function(e){return console.error(e)}).finally(function(){e.video.insertAdjacentHTML("beforeend",t)})}else this.subtitle&&this.backend.getResp(this.subtitle).then(function(s){if(s){var a=new Blob([s],{type:"text/vtt"});t='<track default label="'+e.subLang+'" src="'+URL.createObjectURL(a)+'" kind="subtitles" srclang="'+e.subLang+'" mode="hidden" />'}return{subtitles:t}}).catch(function(e){return console.error(e)}).finally(function(){e.video.insertAdjacentHTML("beforeend",t)})},manageScreen:function(){"exitfullscreen"===event.type?(this.video.textTracks[0].mode="showing",this.Player.api("subtitle",-1)):(this.video.textTracks[0].mode="hidden",this.Player.api("subtitle",0)),this.playerInfo.time=parseInt(this.Player.api("time"),10)},playerBuffered:function(){this.playerInfo.duration=parseInt(this.Player.api("duration"),10),this.playerInfo.time=parseInt(this.Player.api("time"),10)},playerPaused:function(){this.playerInfo.time=parseInt(this.Player.api("time"),10)},sendPlayerData:function(){this.$emit("unload",this.playerInfo)},beforeWindowUnload:function(){this.sendPlayerData()},initPlayer:function(){var e=this.local?"/f/"+this.encodeUrl(this.filename+".mp4"):this.videoSource,t=this.local?"/s/"+this.encodeUrl(this.filename,"subs"):"["+this.playerLangs[this.subLang]+"]"+this.subtitle;this.Player=new Playerjs({id:"player",file:e,title:this.title,poster:this.preview,subtitle:t}),this.showPlayer=!0,this.Player&&this.applyListeners()}},created:function(){this.showPlayer=!0},beforeDestroy:function(){this.deactivateListeners()}},oe={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"mainPlayer",staticClass:"player",attrs:{id:"player"}})},staticRenderFns:[]};var re=s("VU/8")(ne,oe,!1,function(e){s("syA5")},"data-v-9e09b60c",null).exports,le={name:"MediaElement",components:{selecter:ie,msplayer:re},data:function(){return{backend:new k,uid:null,message:null,media:null,extra:null,currentSeason:null,episodeForm:!1,activeSeason:null,loading:!0,showPlayer:!1,player:null,video:null,playerInfo:{duration:null,time:null},params:{continue:null},episodeInfo:{mediaType:"tv",season:null,episode:null}}},methods:{retreiveMediaInfo:function(){var e=this;this.backend.get("/api/media/"+this.uid).then(function(t){t?(e.media=t.body,e.extra=t.extra):console.log(e.backend.msg)}).catch(function(e){return console.error(e)}).finally(function(){console.log(e.media),e.loading=!1,e.showPlayer=!0,e.activeSeason||"tv"!==e.media.media_type||(e.activeSeason=e.detectSeason()),document.title=e.media.name+" » MediaServer","movie"===e.media.media_type&&e.media.meta&&e.$refs.MSPlayer.initPlayer()})},paintRate:function(e){var t="color: #777777";if(e&&"-"!==e){var s=parseInt(10*e,10);s<49?t="color: #ff0000":s>70&&(t="color: #3bb33b")}return t},makePluralSeasons:function(e){return e+" "+["сезон","сезона","сезонов"][e%100>4&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]},makePluralEpisodes:function(e){return e+" "+["эпизод","эпизода","эпизодов"][e%100>4&&e%100<20?2:[2,0,1,1,1,2][e%10<5?e%10:5]]},showEpisodeForm:function(){this.episodeForm=!this.episodeForm},markAsSeen:function(){var e=this,t=this.$refs.seenButton.innerHTML;this.backend.post("/api/mark-seen/"+this.uid).then(function(t){t&&(e.$refs.seenButton.innerHTML='<i class="ms-icon check wh-20"></i>')}).catch(function(e){return console.error(e)}).finally(function(){setTimeout(function(){e.$refs.seenButton.innerHTML=t},2e3)})},transformScroll:function(){if(event.deltaY){var e=0;0!==event.deltaX?e=event.deltaX:0!==event.deltaY&&(e=event.deltaY),this.$refs.eWrap.scrollLeft+=e}},changeSeasonMeta:function(){if(this.episodeInfo.season){var e=this.media.seasons_meta.split(",");this.$refs.episodeInput.max=e[this.episodeInfo.season-1]}},addNewEpisode:function(){var e=this;this.episodeInfo.mediaUid=this.media.uid,this.episodeInfo.tmdb_id=this.media.tmdb_id,this.episodeInfo.kp_id=this.media.kp_id,this.episodeInfo.imdb_id=this.media.imdb_id;var t=this.$refs.episodeButton.textContent;this.$refs.episodeButton.textContent="",this.backend.post("/api/episode/",this.episodeInfo).then(function(t){t&&(e.message=t.message)}).catch(function(e){return console.error(e)}).finally(function(){e.$refs.episodeButton.textContent=t,e.episodeForm=!1,e.activeSeason=e.episodeInfo.season,e.episodeInfo.season=null,e.$refs.selection.clearSelection(),e.episodeInfo.episode=null,e.retreiveMediaInfo(),e.scrollToLastElement()})},downloadEl:function(e){var t=JSON.parse(localStorage.getItem("aDownloads")),s={media_type:this.media.media_type,uid:e};this.backend.post("/api/download/",s).then(function(e){e&&(s.download_id=e.body.uid,t?t.push(s):t=[s])}).catch(function(e){return console.error(e)}).finally(function(){localStorage.setItem("aDownloads",u()(t))})},updateQueue:function(e){var t=JSON.parse(localStorage.getItem("queue")),s={name:this.media.name,title:e.name,season:e.season,episode:e.episode,preview:e.preview,filename:e.meta.filename,uid:e.uid};(t=t||[]).push({type:"episode",episode:s}),localStorage.setItem("queue",u()(t)),window.dispatchEvent(new CustomEvent("queueUpdate",{detail:{storage:localStorage.getItem("queue")}}))},scrollToLastElement:function(){this.$refs.eWrap.scroll({left:this.$refs.eWrap.scrollWidth,behavior:"smooth"})},progressBar:function(e,t){return e?"width: "+e/(60*t)*100+"%":""},detectSeason:function(){var e=null;if(this.currentSeason&&(e=parseInt(this.currentSeason,10)),!this.currentSeason&&this.media.extra.length>=1){e=this.media.seasons_meta.length>=1?this.detectUnwatchedSeason():Math.min.apply(Math,te()(this.media.season_items))}return e},detectUnwatchedSeason:function(){var e=[];return this.media.extra.filter(function(t){return t.seen||e.push(t.season),t.season}),[].concat(te()(new Z.a(e)))[0]},changeSeason:function(e){this.activeSeason=e,this.$router.replace({query:{s:e}})},sendPlayerData:function(e){var t={player:e,mediaType:this.media.media_type,uid:this.uid};this.backend.beacon(t)}},created:function(){this.currentSeason=this.$route.query.s,this.uid=this.$route.params.uid,this.params.continue=this.$route.query.c,this.retreiveMediaInfo()}},ce={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.media?s("article",{staticClass:"media page_wrapper"},[s("div",{staticClass:"page_bg"},[e.media.backdrop?s("img",{attrs:{src:"/i/"+e.media.backdrop}}):e._e()]),e._v(" "),s("div",{staticClass:"media_logo"},[e.media.logo?s("img",{staticClass:"base_image",attrs:{src:"/i/"+e.media.logo}}):e._e()]),e._v(" "),s("div",{staticClass:"media_info"},[s("div",{staticClass:"poster"},[s("img",{staticClass:"base_image",attrs:{src:"/i/"+e.media.poster}}),e._v(" "),e.media.seen?s("div",{staticClass:"seen_wrapper"}):e._e()]),e._v(" "),s("div",{staticClass:"description"},[s("div",{staticClass:"description_info"},[s("div",{staticClass:"description_title"},[e._v("\n          "+e._s(e.media.name)+" ("+e._s(e.media.year)),"tv"===e.media.media_type&&e.media.last_year?s("span",[e._v(" - "+e._s(e.media.last_year)+")\n          ")]):"tv"!==e.media.media_type||e.media.last_year?s("span",[e._v(")")]):s("span",[e._v(" - ...)")])]),e._v(" "),s("div",{staticClass:"rate"},[s("div",{staticClass:"rate_object"},[s("a",{staticClass:"base_link",attrs:{href:"//themoviedb.org/"+e.media.media_type+"/"+e.media.tmdb_id,target:"_blank"}},[s("div",{staticClass:"rate_name tmdb"},[e._v("TMDb")]),e._v(" "),s("div",{staticClass:"rate_value",style:e.paintRate(e.media.tmdb_rate)},[e._v("\n                "+e._s(e.media.tmdb_rate)+"\n              ")])])]),e._v(" "),s("div",{staticClass:"rate_object"},[s("a",{staticClass:"base_link",attrs:{href:"//kinopoisk.ru/film/"+e.media.kp_id,target:"_blank"}},[s("div",{staticClass:"rate_name kp"},[e._v("КП")]),e._v(" "),s("div",{staticClass:"rate_value",style:e.paintRate(e.media.kp_rate)},[e._v("\n                "+e._s(e.media.kp_rate)+"\n              ")])])]),e._v(" "),s("div",{staticClass:"rate_object"},[s("a",{staticClass:"base_link",attrs:{href:"//imdb.com/title/"+e.media.imdb_id,target:"_blank"}},[s("div",{staticClass:"rate_name imdb"},[e._v("iMDB")]),e._v(" "),s("div",{staticClass:"rate_value",style:e.paintRate(e.media.imdb_rate)},[e._v("\n                "+e._s(e.media.imdb_rate)+"\n              ")])])])])]),e._v(" "),s("div",{staticClass:"origin_info"},[e._v("\n        "+e._s(e.media.original_name)+"\n        "),s("div",{staticClass:"age"},[e._v(e._s(e.media.age)+"+")])]),e._v(" "),"tv"===e.media.media_type?s("div",{staticClass:"seasons_info"},[e._v("\n        "+e._s(e.makePluralSeasons(e.media.seasons))+" ("+e._s(e.makePluralEpisodes(e.media.episodes))+")\n      ")]):e._e(),e._v(" "),e.media.slogan?s("div",{staticClass:"slogan"},[e._v("\n        «"+e._s(e.media.slogan)+"»\n      ")]):e._e(),e._v(" "),s("div",{staticClass:"overview"},[e._v("\n        "+e._s(e.media.overview)+"\n      ")])])]),e._v(" "),s("div",{staticClass:"seasons"},["tv"===e.media.media_type?s("div",{staticClass:"seasons_body"},[e._v("\n      Сезон\n      "),s("div",{staticClass:"seasons_counter"},e._l(e.media.season_items,function(t){return s("div",{key:t,staticClass:"seasons_item",class:t===e.activeSeason?"active":""},[s("div",{staticClass:"item_wrapper",on:{click:function(s){return e.changeSeason(t)}}},[e._v(e._s(t))])])}),0)]):s("div",{staticClass:"movie_info"},[e._v(e._s(e.media.name)+" смотреть онлайн")]),e._v(" "),s("div",{staticClass:"actions"},[s("div",{staticClass:"actions_light_button",attrs:{title:"Изменить информацию"}},[s("div",{staticClass:"edit_info"},[s("a",{staticClass:"base_link",attrs:{href:"edit/movie/"+e.media.uid}},[s("i",{staticClass:"ms-icon edit-info wh-20"})])])]),e._v(" "),e.media.seen?e._e():s("div",{staticClass:"actions_light_button",attrs:{title:"Отметить как просмотренный"}},[s("div",{ref:"seenButton",staticClass:"mark_seen",on:{click:e.markAsSeen}},[s("i",{staticClass:"ms-icon seen wh-20"})])]),e._v(" "),"tv"===e.media.media_type?s("div",{staticClass:"actions_light_button"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.episodeForm,expression:"episodeForm"}],staticClass:"episode_form"},[s("form",{on:{submit:function(t){return t.preventDefault(),e.addNewEpisode.apply(null,arguments)}}},[s("selecter",{ref:"selection",attrs:{options:e.media.seasons,placeholder:"Сезон"},on:{input:e.changeSeasonMeta},model:{value:e.episodeInfo.season,callback:function(t){e.$set(e.episodeInfo,"season",t)},expression:"episodeInfo.season"}}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.episodeInfo.episode,expression:"episodeInfo.episode"}],ref:"episodeInput",staticClass:"input_wide",attrs:{type:"number",placeholder:"Эпизод",required:"",min:"1",max:"18"},domProps:{value:e.episodeInfo.episode},on:{input:function(t){t.target.composing||e.$set(e.episodeInfo,"episode",t.target.value)}}}),e._v(" "),s("button",{ref:"episodeButton",staticClass:"btn btn_submit",attrs:{type:"submit"}},[e._v("Добавить")])],1)]),e._v(" "),s("div",{staticClass:"add_episode",on:{click:e.showEpisodeForm}},[s("i",{staticClass:"ms-icon plus wh-20"})])]):e._e(),e._v(" "),"tv"!==e.media.media_type&&e.media.meta?s("div",{staticClass:"actions_light_button"},[e.media.meta.downloaded?s("div",{staticClass:"delete_button",on:{click:function(t){return e.deleteEl(e.media.uid)}}},[s("i",{staticClass:"ms-icon delete wh-20"})]):s("div",{staticClass:"download_button",on:{click:function(t){return e.downloadEl(e.media.uid)}}},[s("i",{staticClass:"ms-icon download wh-20"})])]):e._e(),e._v(" "),e.media.trailer?s("div",{staticClass:"actions_light_button",attrs:{title:"Смотреть трейлер"}},[s("div",{staticClass:"watch_trailer"},[s("a",{staticClass:"base_link",attrs:{href:e.media.trailer,target:"_blank"}},[s("i",{staticClass:"ms-icon video wh-20"})])])]):e._e()])]),e._v(" "),e.media.extra?s("div",{staticClass:"episodes",on:{wheel:function(t){return t.preventDefault(),e.transformScroll.apply(null,arguments)}}},[s("div",{ref:"eWrap",staticClass:"episodes_wrapper"},e._l(e.media.extra,function(t){return t.season===e.activeSeason?s("div",{key:t.uid,staticClass:"episodes_items"},[s("div",{staticClass:"episode_card",attrs:{tabindex:"1"}},[s("img",{staticClass:"preview_image base_image",attrs:{src:"/i/"+t.preview}}),e._v(" "),s("div",{staticClass:"episode_actions"},[s("div",{staticClass:"actions_row first_line"},[s("div",{staticClass:"edit_button small_button"},[s("a",{staticClass:"base_link",attrs:{href:"/edit/"+t.uid}},[s("i",{staticClass:"ms-icon edit-pencil wh-20"})])]),e._v(" "),t.meta&&!t.meta.downloaded?s("div",{staticClass:"download_button small_button",on:{click:function(s){return e.downloadEl(t.uid)}}},[s("i",{staticClass:"ms-icon download wh-20"})]):e._e(),e._v(" "),t.meta&&t.meta.downloaded?s("div",{staticClass:"delete_button small_button",on:{click:function(s){return e.deleteEl(t.uid)}}},[s("i",{staticClass:"ms-icon delete wh-20"})]):e._e(),e._v(" "),t.meta&&!t.meta.downloaded?s("div",{staticClass:"add_queue small_button",on:{click:function(s){return e.updateQueue(t)}}},[s("i",{staticClass:"ms-icon check_list wh-20"})]):e._e()]),e._v(" "),s("div",{staticClass:"actions_row main_line"},[s("div",{staticClass:"watch_episode small_button"},[!t.seen&&t.continue>0?s("a",{staticClass:"base_link",attrs:{href:"/watch/"+t.uid+"?c="+t.continue}},[s("i",{staticClass:"ms-icon play wh-20"})]):s("a",{staticClass:"base_link",attrs:{href:"/watch/"+t.uid}},[s("i",{staticClass:"ms-icon play wh-20"})])])]),e._v(" "),s("div",{staticClass:"actions_row blank_line"},[s("div",{staticClass:"episode_runtime"},[e._v(e._s(t.runtime)+" мин")]),e._v(" "),t.continue&&!t.seen?s("div",{staticClass:"progress_bar"},[s("div",{staticClass:"progress_bar-bar",style:t.seen?"":e.progressBar(t.continue,t.runtime)})]):e._e()])])]),e._v(" "),s("div",{staticClass:"episode_name",class:t.seen?"complete":"",attrs:{title:t.name}},[s("span",{staticClass:"episode_name-long"},[e._v(e._s(t.episode)+". "+e._s(t.name))])]),e._v(" "),s("div",{staticClass:"episode_overview",attrs:{title:t.overview}},[e._v(e._s(t.overview))])]):e._e()}),0)]):s("div",{staticClass:"movies"},[e.media.meta?s("div",{staticClass:"movies_player"},[e.loading?s("div",{staticClass:"loading"},[s("svg",{attrs:{width:"32px",height:"24px"}},[s("polyline",{attrs:{id:"back",points:"1 6 4 6 6 11 10 1 12 6 15 6"}}),e._v(" "),s("polyline",{attrs:{id:"front",points:"1 6 4 6 6 11 10 1 12 6 15 6"}})])]):e._e(),e._v(" "),s("msplayer",{ref:"MSPlayer",attrs:{videoSource:e.media.meta.video_source,preview:"/i/"+e.media.backdrop,title:e.media.name,subtitle:e.media.meta.sub,subLang:e.extra.langs[e.media.meta.sub_lang],continue:e.media.continue,local:e.media.meta.downloaded,filename:e.media.meta.filename},on:{unload:e.sendPlayerData}})],1):e._e()])]):e._e()},staticRenderFns:[]};var ue=s("VU/8")(le,ce,!1,function(e){s("MPUf")},"data-v-0cebb6aa",null).exports,de={name:"fileUpload",props:{preview:{type:Boolean,default:!1},image:{type:String,default:"preview"},name:{type:String},draggable:{type:Boolean,default:!0},existing:{type:String},color:{type:String,default:"#e8f1f233"}},data:function(){return{dragStyle:"",imageUrl:"",uploaded:!1,defaultColor:"#e8f1f233",hoverBg:"59",file:null,imagePreview:null}},methods:{handleDrop:function(){this.$refs.fileInput.files=event.dataTransfer.files,this.dragStyle="",this.preview&&this.makePreview()},handleDragEnd:function(){this.dragStyle=""},handleDragStart:function(){this.dragStyle="active"},makePreview:function(){var e=this.$refs.fileInput;e.files&&e.files[0]&&(this.imagePreview=URL.createObjectURL(e.files[0]),this.uploaded=!0,this.file=e.files[0],this.$emit("input",this.file))},makeExisting:function(e){this.imagePreview=""+e,this.uploaded=!0},deleteSelected:function(){this.imagePreview=null,this.file=null,this.uploaded=!1},styleReplacer:function(e,t){var s=e.split(""),a=s.length-2;return 7===s.length?s.push("5","9"):s.splice(a,2,t),s.join("")}},computed:{cssStyles:function(){return{"--bg-color":this.color,"--hover-bg":this.color?this.styleReplacer(this.color,this.hoverBg):this.styleReplacer(this.defaultColor,this.hoverBg)}}},created:function(){this.existing&&this.makeExisting(this.existing)}},ve={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"file",style:e.cssStyles},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.uploaded,expression:"!uploaded"}],staticClass:"file_upload",class:e.dragStyle+" "+e.image,on:{drop:function(t){return t.preventDefault(),e.handleDrop.apply(null,arguments)},dragleave:function(t){return t.preventDefault(),e.handleDragEnd.apply(null,arguments)},dragover:function(t){return t.preventDefault(),e.handleDragStart.apply(null,arguments)}}},[s("label",{staticClass:"file_upload-label",attrs:{for:"imageInput-"+e.image}},[e._m(0),e._v(" "),s("span",{staticClass:"label_text"},[e._v("Добавить картинку")]),e._v(" "),"avatar"!==e.image?s("span",{staticClass:"label_caption"},[e._v("Выберите или перетащите картинку в это поле")]):e._e()]),e._v(" "),s("input",{ref:"fileInput",staticClass:"image_input",attrs:{type:"file",id:"imageInput-"+e.image,name:e.name},on:{change:e.makePreview}})]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.uploaded&&e.preview,expression:"uploaded && preview"}],staticClass:"file_preview"},[s("div",{staticClass:"file_preview-actions"},[s("div",{staticClass:"delete_selected",attrs:{title:"Удалить файл"},on:{click:e.deleteSelected}},[s("i",{staticClass:"ms-icon delete wh-20"})])]),e._v(" "),s("img",{staticClass:"file_preview-image base_image",attrs:{src:e.imagePreview}})])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"default_image"},[t("i",{staticClass:"ms-icon image wh-30"})])}]};var pe=s("VU/8")(de,ve,!1,function(e){s("Bmq5")},"data-v-32eda252",null).exports,me={name:"EditMeta",components:{selecter:ie,file:pe},data:function(){return{backend:new k,uid:null,loading:!0,voiceLoading:!0,voices:null,media:null,langs:null,selectedVoice:null,defaultLangs:null,episodePreview:null,episodeMeta:{videoSource:null,videoLang:null,sub:null,subLang:null}}},methods:{retrieveMedia:function(){var e=this;this.backend.get("/api/episode/"+this.uid).then(function(t){t&&(e.loading=!1,e.media=t.body,e.langs=t.extra.langs,e.defaultLangs=t.extra.default_langs)}).catch(function(e){return console.error(e)}).finally(function(){e.retrieveVoices(),e.applyOld()})},applyOld:function(){this.media.episode.meta&&(this.episodeMeta.videoSource=this.media.episode.meta.video_source,this.episodeMeta.videoLang=this.media.episode.meta.video_lang,this.episodeMeta.sub=this.media.episode.meta.sub,this.episodeMeta.subLang=this.media.episode.meta.sub_lang)},retrieveVoices:function(){var e=this,t=JSON.parse(localStorage.getItem("user"));this.backend.get("/api/voices/"+this.media.media_type,this.media.episode.short).then(function(t){t&&(e.voices=t.body.results)}).catch(function(e){return console.error(e)}).finally(function(){e.voiceLoading=!1,t.chosen_voice&&e.$refs.voiceSelection.autoSelect(t.chosen_voice)})},handleEditMeta:function(){var e=this,t=!1,s=new FormData;o()(this.episodeMeta).forEach(function(t){return s.append(t,e.episodeMeta[t])}),s.append("preview",this.episodePreview),this.episodeMeta.episodeUid=this.media.episode.uid;var a=this.$refs.editMetaButton.textContent;this.$refs.editMetaButton.textContent="",this.backend.post("/api/meta/edit/"+this.media.media_type+"/"+this.media.episode.uid,s).then(function(e){e&&(t=!0)}).catch(function(e){return console.error(e)}).finally(function(){e.$refs.editMetaButton.textContent=a,t&&setTimeout(function(){location.href="/"+e.media.uid+"?s="+e.media.episode.season},1500)})},parseMeta:function(){var e=this,t=this.media.episode.short.imdb_id,s=this.$refs.autoMetaButton.textContent;this.$refs.autoMetaButton.textContent="";var a={e:"tv"===this.media.media_type?this.media.episode.episode:null,s:"tv"===this.media.media_type?this.media.episode.season:null,voice:this.episodeMeta.videoLang,sub:this.episodeMeta.subLang};this.backend.get("/api/meta/"+this.media.media_type+"/"+t,a).then(function(t){t&&(e.episodeMeta.videoSource=t.results.video_src,e.episodeMeta.sub=t.results.sub_src?t.results.sub_src:"")}).catch(function(e){return console.error(e)}).finally(function(){e.$refs.autoMetaButton.textContent=s})},addPreview:function(){},deletePreview:function(){this.media.episode.preview=null}},created:function(){this.uid=this.$route.params.uid,this.retrieveMedia()}},he={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("article",{staticClass:"edit_meta page_wrapper"},[e.loading?s("div",{staticClass:"loading"},[s("svg",{attrs:{width:"32px",height:"24px"}},[s("polyline",{attrs:{id:"back",points:"1 6 4 6 6 11 10 1 12 6 15 6"}}),e._v(" "),s("polyline",{attrs:{id:"front",points:"1 6 4 6 6 11 10 1 12 6 15 6"}})])]):s("div",{staticClass:"page_content"},[s("div",{staticClass:"page_bg"},[s("img",{staticClass:"base_image",attrs:{src:"/i/"+e.media.backdrop}})]),e._v(" "),s("div",{staticClass:"edit_meta-logo"},[s("img",{staticClass:"base_image",attrs:{src:"/i/"+e.media.logo}})]),e._v(" "),s("div",{staticClass:"edit_meta-container"},[s("div",{staticClass:"leftside"},[s("div",{staticClass:"preview_image"},[s("file",{staticClass:"preview_image",attrs:{image:"preview",preview:"",name:"preview",draggable:"",existing:"/i/"+e.media.episode.preview},model:{value:e.episodePreview,callback:function(t){e.episodePreview=t},expression:"episodePreview"}})],1),e._v(" "),s("div",{staticClass:"episode_name"},[s("span",{staticClass:"episode_title"},[e._v(e._s(e.media.episode.name))]),s("br"),e._v("\n          "+e._s(e.media.episode.season)+" сезон "+e._s(e.media.episode.episode)+" серия\n        ")])]),e._v(" "),s("div",{staticClass:"rightside"},[s("div",{staticClass:"episode_meta"},[s("form",{on:{submit:function(t){return t.preventDefault(),e.handleEditMeta.apply(null,arguments)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.media.episode.name,expression:"media.episode.name"}],staticClass:"input_wide",attrs:{type:"text",required:"",placeholder:"Название"},domProps:{value:e.media.episode.name},on:{input:function(t){t.target.composing||e.$set(e.media.episode,"name",t.target.value)}}}),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.media.episode.overview,expression:"media.episode.overview"}],staticClass:"input_wide textarea_wide",domProps:{value:e.media.episode.overview},on:{input:function(t){t.target.composing||e.$set(e.media.episode,"overview",t.target.value)}}}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.episodeMeta.videoSource,expression:"episodeMeta.videoSource"}],staticClass:"input_wide",attrs:{type:"text",placeholder:"Источник видео"},domProps:{value:e.episodeMeta.videoSource},on:{input:function(t){t.target.composing||e.$set(e.episodeMeta,"videoSource",t.target.value)}}}),e._v(" "),e.voiceLoading||e.voices||e.episodeMeta.videoLang?s("div",{staticClass:"voices"},[e.voiceLoading?s("div",{staticClass:"voice_object input_wide"},[e._v("\n                Загрузка озвучек..\n              ")]):e._e(),e._v(" "),s("selecter",{directives:[{name:"show",rawName:"v-show",value:e.voices,expression:"voices"}],ref:"voiceSelection",attrs:{options:e.voices,multiple:"",placeholder:"Выберите озвучку",updatable:""},model:{value:e.episodeMeta.videoLang,callback:function(t){e.$set(e.episodeMeta,"videoLang",t)},expression:"episodeMeta.videoLang"}})],1):e._e(),e._v(" "),e.voices||e.voiceLoading?e._e():s("div",{staticClass:"voices"},[s("selecter",{ref:"voiceSelection",attrs:{options:e.defaultLangs,multiple:"",placeholder:"Выберите язык"},model:{value:e.episodeMeta.voiceLang,callback:function(t){e.$set(e.episodeMeta,"voiceLang",t)},expression:"episodeMeta.voiceLang"}})],1),e._v(" "),s("transition",{attrs:{name:"toggle"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:"20"===e.episodeMeta.videoLang,expression:"episodeMeta.videoLang === '20'"}],staticClass:"subtitles_wrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.episodeMeta.sub,expression:"episodeMeta.sub"}],staticClass:"input_wide",attrs:{type:"text",placeholder:"Источник субтитров"},domProps:{value:e.episodeMeta.sub},on:{input:function(t){t.target.composing||e.$set(e.episodeMeta,"sub",t.target.value)}}}),e._v(" "),s("selecter",{ref:"subtitlesSelection",attrs:{options:e.langs,multiple:"",placeholder:"Язык субтитров",defaultValue:e.episodeMeta.subLang,updatable:""},model:{value:e.episodeMeta.subLang,callback:function(t){e.$set(e.episodeMeta,"subLang",t)},expression:"episodeMeta.subLang"}})],1)]),e._v(" "),s("button",{ref:"editMetaButton",staticClass:"btn btn_submit",attrs:{type:"submit"}},[e._v("Сохранить")])],1),e._v(" "),e.voices?s("div",{staticClass:"auto_meta"},[s("button",{ref:"autoMetaButton",staticClass:"btn btn_submit autometa",attrs:{type:"button"},on:{click:e.parseMeta}},[e._v("Поиск Источников")]),e._v(" "),s("div",{staticClass:"auto_meta-caption"},[e._v("Укажите озвучку и субтитры перед поиском")])]):e._e(),e._v(" "),e._m(0)])])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"delete_episode"},[t("button",{staticClass:"btn btn_submit red",attrs:{type:"button"}},[this._v("Удалить эпизод")])])}]};var fe=s("VU/8")(me,he,!1,function(e){s("XLUA")},"data-v-5741472a",null).exports,_e={name:"EditElement",components:{file:pe,selecter:ie},data:function(){return{backend:new k,iud:null,loading:!0,extra:null,voiceLoading:!0,voices:null,imageContents:["poster","backdrop","logo"],defaultLangs:null,movieMeta:{videoSource:null,videoLang:null,sub:null,subLang:null},movieInfo:{name:null,originalName:null,overview:null,logo:null,poster:null,backdrop:null}}},methods:{retrieveMedia:function(){var e=this;this.backend.get("/api/media/"+this.uid).then(function(t){t&&(e.media=t.body,e.extra=t.extra)}).catch(function(e){return console.error(e)}).finally(function(){e.loading=!1,e.applyData(),e.retrieveVoices()})},applyData:function(){this.movieInfo.name=this.media.name,this.movieInfo.originalName=this.media.original_name,this.movieInfo.overview=this.media.overview,this.media.meta&&(this.movieMeta.videoSource=this.media.meta.video_source,this.movieMeta.videoLang=this.media.meta.video_lang,this.movieMeta.sub=this.media.meta.sub,this.movieMeta.subLang=this.media.meta.sub_lang)},retrieveVoices:function(){var e=this,t={imdb_id:this.media.imdb_id,media_type:this.media.media_type};this.backend.get("/api/voices/"+this.media.media_type,t).then(function(t){t&&(e.voices=t.body.results)}).catch(function(e){return console.error(e)}).finally(function(){e.voiceLoading=!1})},handleEditMeta:function(){var e=this,t=!1,s=this.$refs.editMetaButton.textContent;this.$refs.editMetaButton.textContent="",this.backend.post("/api/meta/edit/"+this.media.media_type+"/"+this.uid,this.movieMeta).then(function(e){e&&(t=!0)}).catch(function(e){return console.error(e)}).finally(function(){e.$refs.editMetaButton.textContent=s,t&&setTimeout(function(){location.href="/"+e.media.uid},1500)})},parseMeta:function(){var e=this,t={voice:this.movieMeta.videoLang,sub:this.movieMeta.subLang},s=this.$refs.autoMetaButton.textContent;this.$refs.autoMetaButton.textContent="",this.backend.get("/api/meta/"+this.media.media_type+"/"+this.media.imdb_id,t).then(function(t){t&&(e.movieMeta.videoSource=t.results.video_src,e.movieMeta.sub=t.results.sub_src)}).catch(function(e){return console.error(e)}).finally(function(){e.$refs.autoMetaButton.textContent=s})},handelEditInfo:function(){var e=this,t=!1,s=new FormData;o()(this.movieInfo).forEach(function(t){return s.append(t,e.episodeMeta[t])});var a=this.$refs.editInfoButton.textContent;this.$refs.editInfoButton.textContent="",this.backend.post("/api/"+this.media.uid+"/",s).then(function(e){e&&(t=!0)}).finally(function(){e.$refs.editInfoButton.textContent=a,t&&setTimeout(function(){location.href="/"+e.media.uid},1500)})}},created:function(){this.uid=this.$route.params.uid,this.retrieveMedia()}},ge={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("article",{staticClass:"edit_element page_wrapper"},[e.loading?s("div",{staticClass:"loading"},[s("svg",{attrs:{width:"32px",height:"24px"}},[s("polyline",{attrs:{id:"back",points:"1 6 4 6 6 11 10 1 12 6 15 6"}}),e._v(" "),s("polyline",{attrs:{id:"front",points:"1 6 4 6 6 11 10 1 12 6 15 6"}})])]):s("div",{staticClass:"page_content"},[s("div",{staticClass:"page_bg"},[s("img",{staticClass:"base_image",attrs:{src:"/i/"+e.media.backdrop}})]),e._v(" "),s("div",{staticClass:"page_logo"},[e.media.logo?s("img",{staticClass:"base_image",attrs:{src:"/i/"+e.media.logo}}):e._e()]),e._v(" "),s("div",{staticClass:"page_container"},[s("div",{staticClass:"page_container-left"},e._l(e.imageContents,function(t,a){return s("div",{key:a,staticClass:"images"},[s("div",{class:t+"_image"},[s("div",{class:t+"_image-img"},[e.media[t]?s("file",{class:t+"_file",attrs:{image:t,preview:"",name:t,draggable:"",existing:"/i/"+e.media[t]},model:{value:e.movieInfo[t],callback:function(s){e.$set(e.movieInfo,t,s)},expression:"movieInfo[image]"}}):s("file",{class:t+"_file",attrs:{image:t,preview:"",name:t,draggable:""},model:{value:e.movieInfo[t],callback:function(s){e.$set(e.movieInfo,t,s)},expression:"movieInfo[image]"}})],1)])])}),0),e._v(" "),s("div",{staticClass:"page_container-right"},["movie"===e.media.media_type?s("div",{staticClass:"movie_meta"},[s("div",{staticClass:"block_title"},[e._v("Изменить метаданные")]),e._v(" "),s("form",{staticClass:"edit_movie-meta",on:{submit:function(t){return t.preventDefault(),e.handleEditMeta.apply(null,arguments)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.movieMeta.videoSource,expression:"movieMeta.videoSource"}],staticClass:"input_wide",attrs:{type:"text",placeholder:"Источник видео"},domProps:{value:e.movieMeta.videoSource},on:{input:function(t){t.target.composing||e.$set(e.movieMeta,"videoSource",t.target.value)}}}),e._v(" "),e.voiceLoading||e.voices||e.movieMeta.voiceLang?s("div",{staticClass:"voices"},[e.voiceLoading?s("div",{staticClass:"voice_object input_wide"},[e._v("\n                Загрузка озвучек..\n              ")]):e._e(),e._v(" "),s("selecter",{directives:[{name:"show",rawName:"v-show",value:e.voices,expression:"voices"}],ref:"voiceSelection",attrs:{options:e.voices,multiple:"",updatable:"",placeholder:"Выберите озвучку"},model:{value:e.movieMeta.videoLang,callback:function(t){e.$set(e.movieMeta,"videoLang",t)},expression:"movieMeta.videoLang"}})],1):e._e(),e._v(" "),e.voices||e.voiceLoading?e._e():s("div",{staticClass:"voices"},[s("selecter",{ref:"voiceSelection",attrs:{options:e.defaultLangs,multiple:"",placeholder:"Выберите язык"},model:{value:e.movieMeta.videoLang,callback:function(t){e.$set(e.movieMeta,"videoLang",t)},expression:"movieMeta.videoLang"}})],1),e._v(" "),s("transition",{attrs:{name:"toggle"}},["20"===e.movieMeta.videoLang?s("div",{staticClass:"subtitles_wrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.movieMeta.sub,expression:"movieMeta.sub"}],staticClass:"input_wide",attrs:{type:"text",placeholder:"Источник субтитров"},domProps:{value:e.movieMeta.sub},on:{input:function(t){t.target.composing||e.$set(e.movieMeta,"sub",t.target.value)}}}),e._v(" "),s("selecter",{ref:"subtitlesSelection",attrs:{options:e.extra.langs,multiple:"",placeholder:"Язык субтитров",defaultValue:e.movieMeta.subLang,updatable:""},model:{value:e.movieMeta.subLang,callback:function(t){e.$set(e.movieMeta,"subLang",t)},expression:"movieMeta.subLang"}})],1):e._e()]),e._v(" "),s("button",{ref:"editMetaButton",staticClass:"btn btn_submit",attrs:{type:"submit"}},[e._v("Сохранить")])],1),e._v(" "),e.voices?s("div",{staticClass:"auto_meta"},[s("button",{ref:"autoMetaButton",staticClass:"btn btn_submit autometa",attrs:{type:"button"},on:{click:e.parseMeta}},[e._v("Поиск источников")]),e._v(" "),s("div",{staticClass:"auto_meta-caption"},[e._v("Укажите озвучку и субтитры перед поиском")])]):e._e()]):e._e(),e._v(" "),s("div",{staticClass:"movie_info"},[s("div",{staticClass:"block_title"},[e._v("Изменить информацию")]),e._v(" "),s("form",{on:{submit:function(t){return t.preventDefault(),e.handleEditInfo.apply(null,arguments)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.movieInfo.name,expression:"movieInfo.name"}],staticClass:"input_wide",attrs:{type:"text",required:"",placeholder:"Название"},domProps:{value:e.movieInfo.name},on:{input:function(t){t.target.composing||e.$set(e.movieInfo,"name",t.target.value)}}}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.movieInfo.originalName,expression:"movieInfo.originalName"}],staticClass:"input_wide",attrs:{type:"text",required:"",placeholder:"Оригинальное название"},domProps:{value:e.movieInfo.originalName},on:{input:function(t){t.target.composing||e.$set(e.movieInfo,"originalName",t.target.value)}}}),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.movieInfo.overview,expression:"movieInfo.overview"}],staticClass:"input_wide textarea_wide",attrs:{placeholder:"Описание"},domProps:{value:e.movieInfo.overview},on:{input:function(t){t.target.composing||e.$set(e.movieInfo,"overview",t.target.value)}}}),e._v(" "),s("button",{ref:"editInfoButton",staticClass:"btn btn_submit",attrs:{type:"submit"}},[e._v("Сохранить")])])])])])])])},staticRenderFns:[]};var we=s("VU/8")(_e,ge,!1,function(e){s("9jDJ")},"data-v-6977c2b6",null).exports,be={name:"Watch",components:{msplayer:re},data:function(){return{backend:new k,uid:null,media:null,loading:!0,extra:null,video:null,params:{continue:null}}},methods:{retrieveMedia:function(){var e=this;this.backend.get("/api/episode/"+this.uid,{nghbr:!0}).then(function(t){t&&(e.media=t.body,e.extra=t.extra,console.log(e.media))}).catch(function(e){return console.log(e)}).finally(function(){e.$refs.MSPlayer.initPlayer()})},redirect:function(e){location.href=e},sendPlayerData:function(e){var t={player:e,mediaType:this.media.media_type,uid:this.uid};e.timestamp&&e.duration&&this.backend.beacon(t)}},created:function(){this.uid=this.$route.params.uid,this.retrieveMedia(),this.params.continue=this.$route.query.c}},Ce={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("article",{staticClass:"watch page_wrapper"},[e.media?s("div",{staticClass:"page_content"},[e.media.backdrop?s("div",{staticClass:"page_bg"},[s("img",{staticClass:"base_image",attrs:{src:"/i/"+e.media.backdrop}})]):e._e(),e._v(" "),s("div",{staticClass:"watch_logo",on:{click:function(t){return e.redirect("/"+e.media.uid)}}},[e.media.logo?s("img",{staticClass:"base_image",attrs:{src:"/i/"+e.media.logo}}):e._e()]),e._v(" "),s("div",{staticClass:"watch_info"},[s("div",{staticClass:"episode_name"},[e._v(e._s(e.media.episode.name))]),e._v(" "),s("div",{staticClass:"episode_info"},[e._v("\n        "+e._s(e.media.episode.season)+" сезон "+e._s(e.media.episode.episode)+" Серия\n      ")])]),e._v(" "),s("div",{staticClass:"watch_player"},[e.media.prev_episode?s("div",{staticClass:"prev_episode",on:{click:function(t){return e.redirect("/watch/"+e.media.prev_episode.uid)}}},[s("div",{staticClass:"episode_caption"},[s("span",{staticClass:"episode_name"},[e._v(e._s(e.media.prev_episode.name))]),s("br"),e._v("\n          "+e._s(e.media.prev_episode.episode)+" серия\n        ")])]):e._e(),e._v(" "),e.loading?s("div",{staticClass:"loading"},[s("svg",{attrs:{width:"32px",height:"24px"}},[s("polyline",{attrs:{id:"back",points:"1 6 4 6 6 11 10 1 12 6 15 6"}}),e._v(" "),s("polyline",{attrs:{id:"front",points:"1 6 4 6 6 11 10 1 12 6 15 6"}})])]):e._e(),e._v(" "),s("msplayer",{ref:"MSPlayer",attrs:{videoSource:e.media.episode.meta.video_source,preview:"/i/"+e.media.episode.preview,title:e.media.episode.title,subtitle:e.media.episode.meta.sub,subLang:e.media.episode.meta.sub_lang,continue:e.media.episode.continue,local:e.media.episode.meta.downloaded,filename:e.media.episode.meta.filename},on:{unload:e.sendPlayerData}}),e._v(" "),e.media.next_episode?s("div",{staticClass:"next_episode",on:{click:function(t){return e.redirect("/watch/"+e.media.next_episode.uid)}}},[s("div",{staticClass:"episode_caption"},[s("span",{staticClass:"episode_name"},[e._v(e._s(e.media.next_episode.name))]),s("br"),e._v("\n          "+e._s(e.media.next_episode.episode)+" серия\n        ")])]):e._e()],1),e._v(" "),s("div",{staticClass:"watch_overview"},[s("div",{staticClass:"overview_title"},[e._v("Описание")]),e._v(" "),s("p",{staticClass:"overview"},[e._v(e._s(e.media.episode.overview))])])]):e._e()])},staticRenderFns:[]};var ye=s("VU/8")(be,Ce,!1,function(e){s("vNLi")},"data-v-0fb3fb9e",null).exports,ke={name:"CheckBox",props:{label:{type:String,default:"Выбрать"},user:{type:Boolean,default:!1},id:{type:String,default:"check"}},data:function(){return{isSelected:!1}},methods:{changeInput:function(){this.isSelected=!this.isSelected,event.target.checked=this.isSelected,this.$emit("input",this.isSelected)}},updated:function(){var e=this;this.$nextTick(function(){e.user&&(e.isSelected=e.user)})}},xe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"checkbox",on:{click:e.changeInput}},[s("div",{staticClass:"checkbox_box"}),e._v(" "),s("input",{staticClass:"checkbox-input",attrs:{type:"checkbox",name:"check",id:e.id},on:{change:e.changeInput}}),e._v(" "),s("div",{staticClass:"checkbox_check",class:e.isSelected?"checked":""},[s("i",{staticClass:"ms-icon check wh-20"})]),e._v(" "),s("span",{staticClass:"checkbox_label"},[e._v(e._s(e.label))])])},staticRenderFns:[]};var Ie={name:"User",components:{selecter:ie,CheckBox:s("VU/8")(ke,xe,!1,function(e){s("Ekv9")},"data-v-37577eec",null).exports,file:pe},data:function(){return{backend:new k,userInfo:{history:null,downloads:null,queue:null,profile:{uid:null,autoSearch:!1,shareDownloads:!1,avatar:null,chosenVoice:null,username:null,newAvatar:null},isAdmin:!1,color:null},newUser:{username:null,age:null,password:null,email:null},extra:{},isHistoryLong:!1,queueList:JSON.parse(localStorage.getItem("queue"))}},methods:{retrieveUserInfo:function(){var e=this;this.backend.get("/api/user/").then(function(t){t?(e.userInfo.history=t.body.history,e.userInfo.downloads=t.body.downloads,e.userInfo.queue=t.body.queue,e.updateUserInfo(t.extra.user_info),e.extra=t.extra,e.isHistoryLong=!!e.userInfo.history&&e.userInfo.history.length>4):console.log(e.backend.msg)}).catch(function(e){return console.error(e)})},updateUserInfo:function(e){this.userInfo.profile.uid=e.uid,this.userInfo.profile.autoSearch=e.auto_search,this.userInfo.profile.shareDownloads=e.share_downloads,this.userInfo.profile.chosenVoice=e.chosen_voice,this.userInfo.profile.username=e.username,this.userInfo.profile.avatar="/p/"+e.avatar,this.userInfo.isAdmin=e.is_admin,this.userInfo.color=e.user_color},newUserCreate:function(){var e=this,t=this.$refs.newUserButton.textContent;this.$refs.newUserButton.textContent="";var s=this.newUser.password;"string"==typeof this.newUser.password&&(this.newUser.password=[s,s]),this.backend.post("/auth/new/",this.newUser).then(function(t){t&&console.log(e.backend.msg)}).catch(function(e){return console.error(e)}).finally(function(){e.$refs.newUserButton.textContent=t,e.newUser={login:null,password:null,email:null,age:null}})},changeUserInfo:function(){var e=this,t=this.validateFormData(),s=this.$refs.changeUserInfoButton.textContent;this.$refs.changeUserInfoButton.textContent="";var a=new FormData;o()(t).forEach(function(e){return a.append(e,t[e])}),a.append("avatar",this.userInfo.profile.newAvatar),a.delete("newAvatar"),this.backend.post("/api/user/",a).then(function(e){e&&console.log(e)}).catch(function(e){return console.error(e)}).finally(function(){e.$refs.changeUserInfoButton.textContent=s})},changeCheckbox:function(e,t){console.log(e,t)},validateFormData:function(){var e=JSON.parse(localStorage.getItem("user"));return{username:this.userInfo.profile.username!==e.username?this.userInfo.profile.username:null,auto_search:this.userInfo.profile.autoSearch!==e.auto_search?this.translateFunc(this.userInfo.profile.autoSearch):null,share_downloads:this.userInfo.profile.shareDownloads!==e.shareDownloads?this.translateFunc(this.userInfo.profile.shareDownloads):null,voice:this.userInfo.profile.chosenVoice!==e.chosen_voice?this.userInfo.profile.chosenVoice:null}},translateFunc:function(e){return e?"on":"off"},logout:function(){this.$store.dispatch("logout")},clearQueue:function(){this.userInfo.queue?this.backend.post("/api/user/queue/delete").then(function(e){e&&(console.log(e),localStorage.removeItem("queue"))}).catch(function(e){return console.error(e)}).finally(function(){setTimeout(function(){location.reload()},1e3)}):localStorage.removeItem("queue")},downloadAll:function(){var e={queue_id:this.saveQueue(!0),type:"multi"};this.backend.post("/api/download/",e).then(function(e){e&&console.log(e.message)}).catch(function(e){return console.error(e)})},downloadEl:function(e,t){var s=this;this.clearEl(e);var a={filename:t};this.backend.post("/api/download/",a).then(function(e){console.log(e,s.backend.msg)}).catch(function(e){console.error(e)})},downloadElFromQ:function(){var e={queue_id:this.userInfo.extra.queue_id,type:"ofq"};this.backend.post("/api/download/",e).then(function(e){e&&console.log(e.message)}).catch(function(e){return console.error(e)})},clearEl:function(e){var t=JSON.parse(localStorage.getItem("queue"));t.length>2?(t.splice(e,1),localStorage.setItem("queue",u()(t))):localStorage.removeItem("queue")},clearElFromQ:function(e,t,s){var a=this,i={type:t,uid:s};this.backend.delete("/api/user/queue",i).then(function(t){t&&(console.log(t.message),a.userInfo.queue.splice(e,1))}).catch(function(e){return console.error(e)})},saveQueue:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=JSON.parse(localStorage.getItem("queue"));this.backend.post("/api/user/queue",t).then(function(e){var t=null;return e&&(localStorage.removeItem("queue"),t=e.queue_id),t}).catch(function(e){return console.error(e)}).finally(function(){e||setTimeout(function(){location.reload()},1e3)})},clearDownloads:function(){var e=this;this.backend.delete("/api/user/downloads",{type:"all"}).then(function(t){t&&(console.log(t.message),e.userInfo.downloads=null)}).catch(function(e){return console.error(e)})},clearDownload:function(e,t){var s=this,a={type:"one",uid:t};this.backend.delete("/api/user/downloads",a).then(function(t){t&&(console.log(t.message),s.userInfo.downloads.splice(e,1))}).catch(function(e){return console.error(e)})}},computed:{userFormValid:function(){return!!this.userInfo.profile.username&&(this.userInfo.profile.username.length>5||"admin"===this.userInfo.profile.username)}},created:function(){this.retrieveUserInfo()}},Se={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("article",{staticClass:"user page_wrapper"},[s("div",{staticClass:"user_profile"},[e._m(0),e._v(" "),s("div",{staticClass:"user_profile-form"},[s("div",{staticClass:"leftside",style:"background: "+e.userInfo.color+"59;"},[s("form",{staticClass:"user_form",on:{submit:function(t){return t.preventDefault(),e.changeUserInfo.apply(null,arguments)}}},[s("div",{staticClass:"form_row"},[s("div",{staticClass:"form_column small"},[s("div",{staticClass:"avatar"},[e.userInfo.profile.avatar?s("file",{staticClass:"avatar_image",attrs:{image:"avatar",preview:"",name:"avatar",draggable:"",existing:e.userInfo.profile.avatar,color:e.userInfo.color},model:{value:e.userInfo.profile.newAvatar,callback:function(t){e.$set(e.userInfo.profile,"newAvatar",t)},expression:"userInfo.profile.newAvatar"}}):e._e()],1)]),e._v(" "),s("div",{staticClass:"form_column"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.profile.username,expression:"userInfo.profile.username"}],staticClass:"input_wide",attrs:{type:"text",required:"",placeholder:"Логин",id:"cLogin"},domProps:{value:e.userInfo.profile.username},on:{input:function(t){t.target.composing||e.$set(e.userInfo.profile,"username",t.target.value)}}}),e._v(" "),s("selecter",{ref:"userVoiceSelection",attrs:{options:e.extra.voices,multiple:"",placeholder:"Выберите любимую озвучку",updatable:""},model:{value:e.userInfo.profile.chosenVoice,callback:function(t){e.$set(e.userInfo.profile,"chosenVoice",t)},expression:"userInfo.profile.chosenVoice"}}),e._v(" "),s("CheckBox",{attrs:{label:"Автоматический поиск",user:e.userInfo.profile.autoSearch,id:"search_"+e.userInfo.profile.uid},model:{value:e.userInfo.profile.autoSearch,callback:function(t){e.$set(e.userInfo.profile,"autoSearch",t)},expression:"userInfo.profile.autoSearch"}}),e._v(" "),s("CheckBox",{attrs:{label:"Общий доступ к библиотеке",user:e.userInfo.profile.shareDownloads,id:"share_"+e.userInfo.profile.uid},model:{value:e.userInfo.profile.shareDownloads,callback:function(t){e.$set(e.userInfo.profile,"shareDownloads",t)},expression:"userInfo.profile.shareDownloads"}})],1)]),e._v(" "),s("button",{ref:"changeUserInfoButton",staticClass:"btn btn_submit",class:e.userFormValid?"":"not_valid",attrs:{type:"submit",disabled:!e.userFormValid}},[e._v("Сохранить")])])]),e._v(" "),e.userInfo.isAdmin?s("div",{staticClass:"rightside"},[s("div",{staticClass:"form_title"},[e._v("Создать пользователя")]),e._v(" "),s("form",{staticClass:"new_user",on:{submit:function(t){return t.preventDefault(),e.newUserCreate.apply(null,arguments)}}},[s("div",{staticClass:"form_row"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.username,expression:"newUser.username"}],staticClass:"input_wide",attrs:{type:"text",placeholder:"Логин",id:"nuLogin",required:"",autocomplete:"off"},domProps:{value:e.newUser.username},on:{input:function(t){t.target.composing||e.$set(e.newUser,"username",t.target.value)}}}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.age,expression:"newUser.age"}],staticClass:"input_wide",attrs:{type:"number",placeholder:"Возраст",required:"",id:"nuAge"},domProps:{value:e.newUser.age},on:{input:function(t){t.target.composing||e.$set(e.newUser,"age",t.target.value)}}})]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.password,expression:"newUser.password"}],staticClass:"input_wide",attrs:{type:"password",placeholder:"Пароль",required:"",id:"nuPassword"},domProps:{value:e.newUser.password},on:{input:function(t){t.target.composing||e.$set(e.newUser,"password",t.target.value)}}}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.email,expression:"newUser.email"}],staticClass:"input_wide",attrs:{type:"email",placeholder:"Email",required:"",id:"nuEmail"},domProps:{value:e.newUser.email},on:{input:function(t){t.target.composing||e.$set(e.newUser,"email",t.target.value)}}}),e._v(" "),s("button",{ref:"newUserButton",staticClass:"btn btn_submit",attrs:{type:"submit"}},[e._v("Создать")])])]):e._e()]),e._v(" "),s("button",{staticClass:"btn btn_submit btn_exit",attrs:{type:"button"},on:{click:e.logout}},[e._v("Выйти из аккаунта")])]),e._v(" "),e.userInfo.history&&e.userInfo.history.length>1?s("div",{staticClass:"user_history"},[s("div",{staticClass:"block_info"},[s("div",{staticClass:"block_title"},[e._v("История просмотра")]),e._v(" "),s("div",{staticClass:"block_action"},[s("a",{directives:[{name:"show",rawName:"v-show",value:e.isHistoryLong,expression:"isHistoryLong"}],staticClass:"base_link",attrs:{href:"/user/history"}},[e._v("Показать остальное")])])]),e._v(" "),s("div",{staticClass:"user_history-wrapper"},e._l(e.userInfo.history,function(t){return s("div",{key:t.uid,staticClass:"history_item"},[s("div",{staticClass:"history_item-card"},[t.picture?s("img",{staticClass:"base_image preview_image",attrs:{src:"/i/"+t.picture}}):s("img",{staticClass:"base_image preview_image",attrs:{src:"/static/default-history-image.png"}}),e._v(" "),s("div",{staticClass:"history_item-actions"},[s("div",{staticClass:"delete_button",on:{click:function(s){return e.deleteFromHistory(t.uid)}}},[s("i",{staticClass:"ms-icon xmark wh-20"})])])]),e._v(" "),s("div",{staticClass:"history_item-info"},[s("div",{staticClass:"info_name"},[e._v(e._s(t.name))]),e._v(" "),s("div",{staticClass:"info_additional",attrs:{title:t.additional}},[e._v(e._s(t.additional))])])])}),0)]):e._e(),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.queueList&&e.queueList.length>=1||e.userInfo.queue&&e.userInfo.queue.length>=1,expression:"queueList && queueList.length >= 1\n    || userInfo.queue && userInfo.queue.length >= 1"}],staticClass:"user_queue"},[s("div",{staticClass:"block_info"},[s("div",{staticClass:"block_title"},[e._v("Очередь скачивания")]),e._v(" "),s("div",{staticClass:"block_action"},[e.queueList&&e.queueList.length>1?s("a",{staticClass:"base_link",on:{click:e.saveQueue}},[e._v("Сохранить очередь")]):e._e(),e._v(" "),e.queueList&&e.queueList>1||e.userInfo.queue&&e.userInfo.queue.length>1?s("a",{staticClass:"base_link clear_all_button",on:{click:e.clearQueue}},[e._v("\n            Очистить очередь")]):e._e(),e._v(" "),e.queueList&&e.queueList>1||e.userInfo.queue&&e.userInfo.queue.length>1?s("a",{staticClass:"base_link download_all_button",on:{click:e.downloadAll}},[e._v("\n          Скачать все")]):e._e()])]),e._v(" "),s("div",{staticClass:"user_queue-wrapper"},[e._l(e.queueList,function(t,a){return s("div",{key:t[t.type].uid,staticClass:"queue_item"},[s("div",{staticClass:"queue_card"},[s("img",{staticClass:"base_image preview_image",attrs:{src:"/i/"+t[t.type].preview}}),e._v(" "),s("div",{staticClass:"queue_actions"},[s("div",{staticClass:"download_button",on:{click:function(s){return e.downloadEl(t[t.type].filename)}}},[s("i",{staticClass:"ms-icon download wh-20"})]),e._v(" "),s("div",{staticClass:"clear_button",on:{click:function(s){return e.clearEl(a,t.type,t[t.type].uid)}}},[s("i",{staticClass:"ms-icon xmark wh-20"})]),e._v(" "),s("div",{staticClass:"runtime"},[e._v(" "+e._s(t[t.type].runtime))])])]),e._v(" "),s("div",{staticClass:"queue_info"},[s("div",{staticClass:"info_data"},[e._v("\n            "+e._s(t[t.type].name)+" "+e._s(t[t.type].season)+" сезон "+e._s(t[t.type].episode)+" серия\n          ")]),e._v(" "),s("div",{staticClass:"info_name",attrs:{title:t[t.type].title}},[e._v(e._s(t[t.type].title))])])])}),e._v(" "),e._l(e.userInfo.queue,function(t,a){return s("div",{key:t.uid,staticClass:"queue_item"},[s("div",{staticClass:"queue_card"},[s("img",{staticClass:"base_image preview_image",attrs:{src:"/i/"+t.picture,alt:""}}),e._v(" "),s("div",{staticClass:"queue_actions"},[s("div",{staticClass:"download_button",on:{click:function(s){return e.downloadElFromQ(a,t.uid)}}},[s("div",{staticClass:"ms-icon download wh-20"})]),e._v(" "),s("div",{staticClass:"clear_button",on:{click:function(s){return e.clearElFromQ(a,t.type,t.uid)}}},[s("i",{staticClass:"ms-icon xmark wh-20"})]),e._v(" "),s("div",{staticClass:"runtime"},[e._v(" "+e._s(t.runtime)+" мин")])])]),e._v(" "),s("div",{staticClass:"queue_info"},[s("div",{staticClass:"info_data"},[e._v(e._s(t.name))]),e._v(" "),s("div",{staticClass:"info_name",attrs:{title:t.additional}},[e._v(e._s(t.additional))])])])})],2)]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.userInfo.downloads&&e.userInfo.downloads.length>=1,expression:"userInfo.downloads && userInfo.downloads.length >= 1"}],staticClass:"user_downloads"},[s("div",{staticClass:"block_info"},[s("div",{staticClass:"block_title"},[e._v("Загрузки")]),e._v(" "),s("div",{staticClass:"block_action"},[s("a",{staticClass:"base_link clear_all_button",on:{click:e.clearDownloads}},[e._v("Удалить все")]),e._v(" "),s("a",{directives:[{name:"show",rawName:"v-show",value:e.userInfo.downloads&&e.userInfo.downloads.length>4,expression:"userInfo.downloads && userInfo.downloads.length > 4"}],staticClass:"base_link",attrs:{href:"/user/downloads"}},[e._v("Показать остальное")])])]),e._v(" "),s("div",{staticClass:"user_downloads-wrapper"},e._l(e.userInfo.downloads,function(t,a){return s("div",{key:t.uid,staticClass:"downloads"},[s("div",{staticClass:"downloads_card"},[s("img",{staticClass:"base_image preview_image",attrs:{src:"/i/"+t.preview}}),e._v(" "),t.completed?s("div",{staticClass:"downloads_actions"},[s("a",{staticClass:"base_link watch_button base_button",attrs:{href:"/watch/"+t.watch_uid}},[s("i",{staticClass:"ms-icon play wh-20"})]),e._v(" "),s("div",{staticClass:"clear_button",on:{click:function(s){return e.clearDownload(a,t.uid)}}},[s("i",{staticClass:"ms-icon xmark wh-20"})]),e._v(" "),s("div",{staticClass:"runtime"},[e._v(e._s(parseInt(t.runtime/60,10))+" мин")])]):s("div",{staticClass:"downloads_progress"},[s("div",{staticClass:"progress_bar"},[s("div",{staticClass:"progress_bar-count",style:e.progressStyles(t.uid),attrs:{title:e.convertToText(t.uid)}})])])]),e._v(" "),s("div",{staticClass:"downloads_info"},[s("div",{staticClass:"info_data"},[e._v(e._s(t.name))]),e._v(" "),t.title?s("div",{staticClass:"info_name"},[e._v(e._s(t.title))]):e._e()])])}),0)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"block_info"},[t("div",{staticClass:"block_title"},[this._v("Настройки профиля")])])}]};var Le=s("VU/8")(Ie,Se,!1,function(e){s("0euI")},"data-v-a2fd666c",null).exports;a.a.use(q.a);var $e=new q.a({mode:"history",routes:[{path:"/",name:"Главная",component:V},{path:"/sign-in",name:"Авторизация",component:j},{path:"/search",name:"Глобальный поиск",component:Y},{path:"/tv",name:"Сериалы",meta:{mediaType:"tv"},component:K},{path:"/movie",name:"Фильмы",meta:{mediaType:"movie"},component:K},{path:"/user",name:"Профиль",component:Le},{path:"/watch/:uid",name:"Смотреть",component:ye},{path:"/edit/:uid",name:"Изменить метаданные",component:fe},{path:"/edit/movie/:uid",name:"Изменить информацию",component:we},{path:"/:uid",name:"",component:ue}]});$e.beforeEach(function(e,t,s){var a=R.getters.isAuthenticated;e.matched.some(function(e){return e.meta.requiresAuth})&&!a?s("/sign-in"):s()});var Me=$e;s("erTq");a.a.config.productionTip=!1,a.a.use(i.a),new a.a({el:"#app",router:Me,store:R,components:{App:P},render:function(e){return e(P)},template:"<App/>"})},Vrte:function(e,t){},XLUA:function(e,t){},crH4:function(e,t){},erTq:function(e,t){},hpD4:function(e,t){},lfw6:function(e,t){},pdYJ:function(e,t){},py20:function(e,t){},syA5:function(e,t){},vNLi:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.e8d8f6230434b8d9a4b5.js.map